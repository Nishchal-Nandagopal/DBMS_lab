CREATE DATABASE ORDER_PROCESSING;
USE ORDER_PROCESSING;
CREATE TABLE CUSTOMER(CUST_ID INT,CNAME VARCHAR(30),CITY VARCHAR(30),PRIMARY KEY(CUST_ID));
CREATE TABLE ORDERS(ORDER_ID INT,ORDER_DATE DATE,CUST_ID INT,ORDER_AMOUNT INT,PRIMARY KEY(ORDER_ID),
FOREIGN KEY(CUST_ID) REFERENCES CUSTOMER(CUST_ID) ON DELETE CASCADE);
CREATE TABLE ITEM(ITEM_ID INT,UNITPRICE INT,PRIMARY KEY(ITEM_ID));
CREATE TABLE ORDERITEM(ORDER_ID INT,ITEM_ID INT,QTY INT,
FOREIGN KEY(ORDER_ID) REFERENCES ORDERS(ORDER_ID) ON DELETE SET NULL,FOREIGN KEY(ITEM_ID) REFERENCES ITEM(ITEM_ID) ON DELETE SET NULL);
CREATE TABLE WAREHOUSE(WAREHOUSE_ID INT,CITY VARCHAR(30),PRIMARY KEY(WAREHOUSE_ID));
CREATE TABLE SHIPMENT(ORDER_ID INT,WAREHOUSE_ID INT,SHIPDATE DATE,
FOREIGN KEY(ORDER_ID) REFERENCES ORDERS(ORDER_ID) ON DELETE CASCADE,
FOREIGN KEY(WAREHOUSE_ID) REFERENCES WAREHOUSE(WAREHOUSE_ID) ON DELETE CASCADE);
SHOW TABLES;
INSERT INTO CUSTOMER(CUST_ID,CNAME,CITY) VALUES (771, 'PUSHPA K','BANGALORE');
INSERT INTO CUSTOMER(CUST_ID,CNAME,CITY) VALUES(772, 'SUMAN', 'MUMBAI');
INSERT INTO CUSTOMER(CUST_ID,CNAME,CITY) VALUES(773,'SOURAV','CALICUT');
INSERT INTO CUSTOMER(CUST_ID,CNAME,CITY) VALUES(774, 'LAILA', 'HYDERABAD');
INSERT INTO CUSTOMER(CUST_ID,CNAME,CITY) VALUES(775, 'FAIZAL',' BANGALORE');
DESC CUSTOMER;
SELECT * FROM CUSTOMER;
INSERT INTO ORDERS(ORDER_ID,ORDER_DATE,CUST_ID,ORDER_AMOUNT) VALUES (111, '2002-01-22', 771, 18000);
INSERT INTO ORDERS(ORDER_ID,ORDER_DATE,CUST_ID,ORDER_AMOUNT) VALUES(112, '2002-07-30', 774, 6000);
INSERT INTO ORDERS(ORDER_ID,ORDER_DATE,CUST_ID,ORDER_AMOUNT) VALUES(113, '2003-04-03', 775, 9000);
INSERT INTO ORDERS(ORDER_ID,ORDER_DATE,CUST_ID,ORDER_AMOUNT) VALUES(114, '2003-11-03', 775, 29000);
INSERT INTO ORDERS(ORDER_ID,ORDER_DATE,CUST_ID,ORDER_AMOUNT) VALUES(115, '2003-12-10', 773, 29000);
INSERT INTO ORDERS(ORDER_ID,ORDER_DATE,CUST_ID,ORDER_AMOUNT) VALUES(116, '2004-08-19', 772, 56000);
INSERT INTO ORDERS(ORDER_ID,ORDER_DATE,CUST_ID,ORDER_AMOUNT) VALUES(117, '2004-09-10', 771, 20000);
INSERT INTO ORDERS(ORDER_ID,ORDER_DATE,CUST_ID,ORDER_AMOUNT) VALUES(118, '2004-11-20',775, 29000);
INSERT INTO ORDERS(ORDER_ID,ORDER_DATE,CUST_ID,ORDER_AMOUNT) VALUES(119, '2005-02-13', 774, 29000);
INSERT INTO ORDERS(ORDER_ID,ORDER_DATE,CUST_ID,ORDER_AMOUNT) VALUES(120, '2005-10-13', 775 ,29000);
DESC ORDERS;
SELECT * FROM ORDERS;
INSERT INTO ITEM(ITEM_ID, UNITPRICE) VALUES (5001, 503);
INSERT INTO ITEM(ITEM_ID, UNITPRICE) VALUES(5002, 750);
INSERT INTO ITEM(ITEM_ID, UNITPRICE) VALUES(5003, 150);
INSERT INTO ITEM(ITEM_ID, UNITPRICE) VALUES(5004, 600);
INSERT INTO ITEM(ITEM_ID, UNITPRICE) VALUES(5005, 890);
DESC ITEM;
SELECT * FROM ITEM;
INSERT INTO ORDERITEM(ORDER_ID,ITEM_ID,QTY) VALUES(111, 5001, 50);
INSERT INTO ORDERITEM(ORDER_ID,ITEM_ID,QTY) VALUES(112, 5003, 20);
INSERT INTO ORDERITEM(ORDER_ID,ITEM_ID,QTY) VALUES(113, 5002, 50);
INSERT INTO ORDERITEM(ORDER_ID,ITEM_ID,QTY) VALUES(114, 5005, 60);
INSERT INTO ORDERITEM(ORDER_ID,ITEM_ID,QTY) VALUES(115, 5004, 90);
INSERT INTO ORDERITEM(ORDER_ID,ITEM_ID,QTY) VALUES(116, 5001, 10);
INSERT INTO ORDERITEM(ORDER_ID,ITEM_ID,QTY) VALUES(117, 5003, 80);
INSERT INTO ORDERITEM(ORDER_ID,ITEM_ID,QTY) VALUES(118, 5005, 50);
INSERT INTO ORDERITEM(ORDER_ID,ITEM_ID,QTY) VALUES(119, 5002, 10);
INSERT INTO ORDERITEM(ORDER_ID,ITEM_ID,QTY) VALUES(120, 5004, 45);
DESC ORDERITEM;
SELECT * FROM ORDERITEM;

INSERT INTO WAREHOUSE(WAREHOUSE_ID,CITY) VALUES (1,'DELHI');
INSERT INTO WAREHOUSE(WAREHOUSE_ID,CITY) VALUES(2,'BOMBAY');
INSERT INTO WAREHOUSE(WAREHOUSE_ID,CITY) VALUES(3,'CHENNAI');
INSERT INTO WAREHOUSE(WAREHOUSE_ID,CITY) VALUES(4,'BANGALORE');
INSERT INTO WAREHOUSE(WAREHOUSE_ID,CITY) VALUES(5,'BANGALORE');
INSERT INTO WAREHOUSE(WAREHOUSE_ID,CITY) VALUES(6,'DELHI');
INSERT INTO WAREHOUSE(WAREHOUSE_ID,CITY) VALUES(7,'BOMBAY');
INSERT INTO WAREHOUSE(WAREHOUSE_ID,CITY) VALUES(8,'CHENNAI');
INSERT INTO WAREHOUSE(WAREHOUSE_ID,CITY) VALUES(9,'DELHI');
INSERT INTO WAREHOUSE(WAREHOUSE_ID,CITY) VALUES(10,'BANGALORE');
DESC WAREHOUSE;
SELECT * FROM WAREHOUSE;                                                
INSERT INTO SHIPMENT(ORDER_ID,WAREHOUSE_ID,SHIPDATE) VALUES (111,1,'2002-02-10');
INSERT INTO SHIPMENT(ORDER_ID,WAREHOUSE_ID,SHIPDATE) VALUES(112, 5 ,'2002-09-10');
INSERT INTO SHIPMENT(ORDER_ID,WAREHOUSE_ID,SHIPDATE) VALUES(113, 8 ,'2003-02-10');
INSERT INTO SHIPMENT(ORDER_ID,WAREHOUSE_ID,SHIPDATE) VALUES(114, 3 ,'2003-12-10');
INSERT INTO SHIPMENT(ORDER_ID,WAREHOUSE_ID,SHIPDATE) VALUES(115,9 ,'2004-01-19');
INSERT INTO SHIPMENT(ORDER_ID,WAREHOUSE_ID,SHIPDATE) VALUES(116, 1, '2004-09-20');
INSERT INTO SHIPMENT(ORDER_ID,WAREHOUSE_ID,SHIPDATE) VALUES(117, 5 ,'2004-09-10');
INSERT INTO SHIPMENT(ORDER_ID,WAREHOUSE_ID,SHIPDATE) VALUES(118, 7 ,'2004-11-30');
INSERT INTO SHIPMENT(ORDER_ID,WAREHOUSE_ID,SHIPDATE) VALUES(119, 7 ,'2005-04-30');
INSERT INTO SHIPMENT(ORDER_ID,WAREHOUSE_ID,SHIPDATE) VALUES(120, 6 ,'2005-12-21');
DESC SHIPMENT;
SELECT * FROM SHIPMENT;                                                            

SELECT C.CNAME,COUNT(O.ORDER_ID) AS TOTALORDERS,AVG(O.ORDER_AMOUNT) AS AVG_ORDER_AMT FROM CUSTOMER C,ORDERS O WHERE C.CUST_ID=O.CUST_ID GROUP BY O.CUST_ID;


SELECT S.ORDER_ID FROM SHIPMENT S,WAREHOUSE W WHERE S.WAREHOUSE_ID=W.WAREHOUSE_ID AND W.CITY="BANGALORE";


DELETE FROM ITEM WHERE ITEM_ID=5002;
SELECT * FROM ORDERITEM;
COMMIT;